<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpendWise | Expense Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<style>
  body { font-family: 'Inter', sans-serif; background-color: #f4f7f6; color: #333; }
        .main-card { border: none; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        .balance-text { font-size: 2.5rem; font-weight: 700; letter-spacing: -1px; }
        .inc-exp-container { border-radius: 12px; background: #fff; padding: 20px; display: flex; justify-content: space-around; text-align: center; }
        .money { font-size: 1.25rem; font-weight: 600; }
        .plus { color: #2ecc71; }
        .minus { color: #e74c3c; }
        .list-group-item { border-left-width: 5px !important; margin-bottom: 8px; border-radius: 8px !important; transition: 0.2s; }
        .list-group-item:hover { background-color: #fcfcfc; transform: scale(1.01); }
        .border-plus { border-left-color: #2ecc71 !important; }
        .border-minus { border-left-color: #e74c3c !important; }
        .btn-primary { background-color: #6c5ce7; border: none; padding: 10px; font-weight: 600; }
        .btn-primary:hover { background-color: #5b4cc4; }
        .delete-btn { color: #ced4da; transition: 0.2s; }
        .delete-btn:hover { color: #e74c3c; }
</style>
<body>

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-6 col-lg-5">
            
            <div class="text-center mb-4">
                <h2 class="fw-bold">Expense Tracker</h2>
            </div>

            {% if messages %}
                {% for message in messages %}
                <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
                {% endfor %}
            {% endif %}

            <div class="text-center mb-4">
                <p class="text-uppercase text-muted small fw-bold mb-0">Your Balance</p>
                <h1 class="balance-text mb-4" id="balance">${{ current_balance }}</h1>
                
                <div class="inc-exp-container shadow-sm">
                    <div>
                        <p class="small text-uppercase mb-1 fw-medium">Income</p>
                        <p id="money-plus" class="money plus mb-0">+${{ income }}</p>
                    </div>
                    
                    <div>
                        <p class="small text-uppercase mb-1 fw-medium">Expenses</p>
                        <p id="money-minus" class="money minus mb-0">-${{ expense }}</p>
                    </div>
                </div>
            </div>

            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5 class="fw-bold mb-0">History</h5>
            </div>
            
            <ul class="list-group list-group-flush mb-4">
                {% for entry in history %}
                <li class="list-group-item d-flex justify-content-between align-items-center shadow-sm 
                    {% if entry.expense_type == 'DEBIT' %} border-minus {% else %} border-plus {% endif %}">
                    <div>
                        <span class="d-block fw-medium">{{ entry.description }}</span>
                        <small class="text-muted">Transaction Type: {{ entry.expense_type }}</small>
                    </div>
                    <div class="d-flex align-items-center">
                        <span class="me-3 fw-bold {% if entry.expense_type == 'DEBIT' %} text-danger {% else %} text-success {% endif %}">
                            {% if entry.expense_type == 'DEBIT' %}-{% else %}+{% endif %}${{ entry.amount }}
                        </span>
                        <a class="delete-btn" href="{% url 'delete_transaction' entry.id %}">
                            <i class="fas fa-trash-alt"></i>
                        </a>
                    </div>
                </li>
                {% empty %}
                <li class="list-group-item text-center text-muted py-3">No transactions yet.</li>
                {% endfor %}
            </ul>

            <div class="card main-card p-4">
                <h5 class="fw-bold mb-3">Add New Transaction</h5>
                <form id="form" method="post">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label for="text" class="form-label small fw-bold text-muted">Description</label>
                        <input type="text" class="form-control form-control-lg bg-light" id="text" name="desc" placeholder="What was this for?" required />
                    </div>
                    <div class="mb-3">
                        <label for="amount" class="form-label small fw-bold text-muted">
                            Amount <span class="text-lowercase fw-normal">(Negative for expense)</span>
                        </label>
                        <input type="number" step="0.01" class="form-control form-control-lg bg-light" id="amount" name="amount" placeholder="0.00" required />
                    </div>
                    <button class="btn btn-primary w-100 py-2 shadow-sm" type="submit">
                        <i class="fas fa-plus-circle me-2"></i>Add Transaction
                    </button>
                </form>
            </div>

        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>